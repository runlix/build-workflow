# Test Dockerfile for base image - AMD64 Debug variant
# This wraps a distroless debug image (includes busybox shell)

ARG UPSTREAM_IMAGE
ARG UPSTREAM_TAG
ARG UPSTREAM_DIGEST

FROM ${UPSTREAM_IMAGE}:${UPSTREAM_TAG}@${UPSTREAM_DIGEST}

# Add a simple test marker file
# Debug images include busybox for runtime, but still no shell during build
# Use COPY with heredoc like standard variant
COPY --chmod=0644 <<EOF /etc/build-info
{
  "arch": "amd64",
  "base_image": "${UPSTREAM_IMAGE}",
  "base_tag": "${UPSTREAM_TAG}",
  "base_digest": "${UPSTREAM_DIGEST}",
  "variant": "debug"
}
EOF

# Debug variant includes busybox shell for runtime troubleshooting
